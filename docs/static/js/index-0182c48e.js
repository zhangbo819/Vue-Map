import{_ as E,g as j}from"./index-4236053b.js";import{Y as I}from"./YearHeader-cf33c023.js";import{e as y,w as h,E as w,k as b,r as f,x,f as g,u as k,s as z,z as N,C as D,D as L}from"./@vue_runtime-core@3.2.47-3f4c49b0.js";import{r as c}from"./@vue_reactivity@3.2.47-9d7d88d9.js";import{r as V}from"./index-e1fb4653.js";import{I as B}from"./@vue_shared@3.2.47-19384108.js";import{_ as S}from"./MyTable-183e9a1c.js";import"./@vue_runtime-dom@3.2.47-0c0c6f75.js";import"./vue-router@4.2.2_vue@3.2.47-f5537a5c.js";import"./vant@4.6.0_vue@3.2.47-8dfe671f.js";import"./@vant_use@1.5.2_vue@3.2.47-02c87728.js";const Y=y({__name:"CompanyChart",props:{data:null},setup(s){const r=s;h(()=>r.data,()=>{n()}),w(()=>{window.addEventListener("resize",d),n()}),b(()=>{window.removeEventListener("resize",d)});const o=c();let t;const n=()=>{console.log("data",r.data);const i=r.data.reduce((a,l)=>(l.children.forEach(v=>{v.children.forEach(u=>{a.push(u)})}),a),[]).sort((a,l)=>Number(a.index)-Number(l.index)).slice(0,20),p={title:{text:"前20公司"},dataset:[{dimensions:["name","revenue","profession","index"],source:i.map(a=>[a.name.replace(/(股份)?有限公司/,""),a.revenue,a.address,a.index])},{transform:{type:"sort",config:{dimension:"index",order:"asc"}}}],xAxis:{type:"category",axisLabel:{interval:0,rotate:30}},yAxis:{name:"营收(万元)"},series:{type:"bar",encode:{x:"name",y:"score"},datasetIndex:1},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}}};t=window.echarts.init(o.value),t.setOption(p)},d=()=>{t&&t.resize&&t.resize()};return(i,p)=>(x(),f("div",{ref_key:"refMap",ref:o,style:{"min-height":"550px",width:"100%",margin:"auto"}},null,512))}}),M=s=>(D("data-v-ccb87406"),s=s(),L(),s),O=M(()=>z("div",{id:"main",style:{"min-height":"550px",width:"100%",margin:"auto"}},null,-1)),q={key:0},P=y({__name:"index",setup(s){const r=c([{name:"南海诸岛"},{ename:"beijing",name:"北京"},{ename:"tianjin",name:"天津"},{ename:"shanghai",name:"上海"},{ename:"chongqing",name:"重庆"},{ename:"hebei",name:"河北"},{ename:"henan",name:"河南"},{ename:"yunnan",name:"云南"},{ename:"liaoning",name:"辽宁"},{ename:"heilongjiang",name:"黑龙江"},{ename:"hunan",name:"湖南"},{ename:"anhui",name:"安徽"},{ename:"shandong",name:"山东"},{ename:"xinjiang",name:"新疆"},{ename:"jiangsu",name:"江苏"},{ename:"zhejiang",name:"浙江"},{ename:"jiangxi",name:"江西"},{ename:"hubei",name:"湖北"},{ename:"guangxi",name:"广西"},{ename:"gansu",name:"甘肃"},{ename:"shanxi",name:"山西"},{ename:"neimenggu",name:"内蒙古"},{ename:"shanxi1",name:"陕西"},{ename:"jilin",name:"吉林"},{ename:"fujian",name:"福建"},{ename:"guizhou",name:"贵州"},{ename:"guangdong",name:"广东"},{ename:"qinghai",name:"青海"},{ename:"xizang",name:"西藏"},{ename:"sichuan",name:"四川"},{ename:"ningxia",name:"宁夏"},{ename:"hainan",name:"海南"},{name:"台湾"},{ename:"xianggang",name:"香港"},{ename:"aomen",name:"澳门"}]),o=c(new Date().getFullYear()),t=c(""),n=c([]);h(()=>o.value,async()=>{n.value=await j(o.value)},{immediate:!0});const d=c();h([()=>o.value,()=>n.value],async()=>{d.value=n.value.find(u=>u.name.includes(t.value))},{immediate:!0}),h(()=>n.value,()=>{a()}),w(()=>{console.log("china mounted"),window.addEventListener("resize",l),a()}),b(()=>{window.removeEventListener("resize",l)});let i,p={};const a=()=>{console.log("currentData",n.value),r.value.forEach((e,m)=>{const _=n.value.find(C=>C.name.includes(e.name));r.value[m].value=_?_.count:0}),i=window.echarts.init(document.getElementById("main"));const u={tooltip:{formatter(e,m){return e.seriesName+"<br />"+e.name+"："+e.value}},visualMap:{min:0,max:n.value.reduce((e,m)=>(m.count>e&&(e=m.count),e),0),left:"left",top:"bottom",text:["高","低"],inRange:{color:["#e0ffff","blue"]},show:!0},geo:{map:"china",roam:!1,zoom:1,label:{normal:{show:!0,fontSize:"10",color:"rgba(0,0,0,0.7)"}},itemStyle:{normal:{borderColor:"rgba(0, 0, 0, 0.2)"},emphasis:{areaColor:"skyblue",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:20,borderWidth:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},series:[{name:"省份",type:"map",geoIndex:0,data:r.value}]};i.setOption(u),i.on("click",e=>{if(!e.data.ename){alert("暂无"+e.name+"地图数据");return}t.value=e.data.name,p={provinceName:e.data.ename,province:e.name,year:o.value}})},l=()=>{i&&i.resize&&i.resize()},v=()=>{V.push({path:"/province",query:p})};return(u,e)=>(x(),f("div",null,[g(I,{modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=m=>o.value=m),"year-list":[2021,2022,2023]},null,8,["modelValue"]),g(Y,{data:n.value},null,8,["data"]),O,t.value?(x(),f("p",q,[k(B(t.value)+"   ",1),z("span",{style:{"text-decoration-line":"underline"},onClick:v},"详情")])):N("",!0),g(E,{"province-data":d.value,"is-details":!1},null,8,["province-data"])]))}});const K=S(P,[["__scopeId","data-v-ccb87406"]]);export{K as default};
